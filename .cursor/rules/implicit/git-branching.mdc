---
description: Git branching model and conventions for TypeScript projects
alwaysApply: true
---

# Git Branching Model for TypeScript Projects

## Main Branch

- `master` - Production-ready code
- Protected branch
- All features merge here via Pull Requests
- Always deployable

## Branch Naming Conventions

### Feature Branches (MUST include issue number)
```bash
feature/{issue-num}-{descriptive-name}
```

Examples:
- `feature/42-add-dashboard-component`
- `feature/43-implement-api-integration`
- `feature/44-add-user-authentication`
- `feature/45-add-theme-toggle`

**REQUIRED**: Every branch MUST link to an issue for provenance

### Bug Fix Branches (MUST include issue number)
```bash
bugfix/{issue-num}-{issue-description}
```

Examples:
- `bugfix/46-component-alignment`
- `bugfix/47-api-error-handling`
- `bugfix/48-mobile-responsive`

### Hotfix Branches (Critical Production Fixes)
```bash
hotfix/critical-issue
```

Examples:
- `hotfix/security-vulnerability`
- `hotfix/api-token-leak`
- `hotfix/broken-deployment`

### TypeScript Upgrade Branches
```bash
debug/typescript-upgrade
```

Examples:
- `debug/typescript-upgrade`
- `debug/react-19-migration`
- `debug/vite-6-upgrade`

### GitHub Workflow Debugging
```bash
debug/gh-workflow-debugging
```

Examples:
- `debug/gh-workflow-debugging`
- `debug/container-build-fix`

### Refactoring Branches
```bash
refactor/area-description
```

Examples:
- `refactor/component-structure`
- `refactor/api-service-layer`
- `refactor/state-management`

## Branch Creation Workflow

### Creating Feature Branch (LINKED TO ISSUE):
```bash
# 1. Create issue FIRST on GitHub
gh issue create --title "Add dashboard component" --label "feature,phase-3"
# Returns: Created issue #42

# 2. Ensure master is up to date
git checkout master
git pull origin master

# 3. Create branch with issue number
git checkout -b feature/42-add-dashboard-component

# 4. Work on feature
# ... make changes ...

# 5. Commit with issue reference
git commit -m "feat: add dashboard component (#42)"

# 6. Push to remote
git push -u origin feature/42-add-dashboard-component

# 7. Create PR that closes issue
gh pr create --title "Add dashboard component" --body "Closes #42"
```

### Creating Bugfix Branch:
```bash
git checkout master
git pull origin master
git checkout -b bugfix/mobile-layout
```

### Creating Hotfix Branch:
```bash
git checkout master
git pull origin master
git checkout -b hotfix/security-patch
```

## Commit Message Conventions

Use Conventional Commits format:

### Types:
- `feat:` - New feature
- `fix:` - Bug fix
- `docs:` - Documentation changes
- `style:` - Code style changes (formatting, no logic change)
- `refactor:` - Code refactoring
- `perf:` - Performance improvements
- `test:` - Adding or updating tests
- `chore:` - Maintenance tasks
- `ci:` - CI/CD changes

### Examples:
```bash
feat: add GitHub OAuth authentication
fix: resolve mobile layout overflow issue
docs: update README with container instructions
style: format code with prettier
refactor: extract API logic into service layer
perf: optimize 3D rendering performance
test: add unit tests for repo card component
chore: update dependencies
ci: add container build to GitHub workflow
```

### Scope (optional):
```bash
feat(component): add dashboard widget
fix(api): handle error responses
docs(readme): add deployment instructions
```

## Pull Request Workflow

### Creating Pull Request:
1. Push feature branch to remote
2. Create PR from feature branch to `master`
3. Fill PR template:
   - Description of changes
   - Related issues
   - Testing done
   - Screenshots (for UI changes)
4. Request reviewers
5. CI/CD checks must pass
6. Await approval
7. Merge using "Squash and merge" or "Rebase and merge"

### PR Title Format:
```
feat: Add dashboard component
fix: Resolve mobile responsive issues
docs: Update deployment documentation
```

## Merging Strategy

### Preferred: Squash and Merge
- Keeps master history clean
- All commits from feature squashed into one
- Use for most features

### Alternative: Rebase and Merge
- Preserves commit history
- Use for well-structured commits
- Better for reviewing individual changes

### Avoid: Merge Commit
- Creates unnecessary merge commits
- Clutters git history

## Branch Protection Rules

### master branch:
- ✅ Require pull request reviews (at least 1)
- ✅ Require status checks to pass
  - Build workflow
  - Test workflow
  - Linting
  - Type checking
- ✅ Require branches to be up to date
- ✅ Require signed commits (optional)
- ❌ Allow force pushes
- ❌ Allow deletions

## Branch Lifecycle

### Feature Branch:
```bash
master → feature/new-feature
          ↓ (work + commits)
          ↓ (PR created)
          ↓ (CI passes)
          ↓ (review approved)
          → master (merged)
          ↓
       (delete branch)
```

### Hotfix Branch:
```bash
master → hotfix/critical-fix
          ↓ (quick fix)
          ↓ (test)
          ↓ (PR + fast review)
          → master (merged)
          ↓
       (tag release)
          ↓
       (delete branch)
```

## Release Workflow

### Creating Release:
```bash
# Ensure master is ready
git checkout master
git pull origin master

# Create and push tag
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0

# GitHub Actions will handle:
# - Building containers
# - Running tests
# - Creating GitHub release
# - Pushing to container registry
```

### Version Tagging:
- Follow semantic versioning: `v{MAJOR}.{MINOR}.{PATCH}`
- Examples: `v1.0.0`, `v1.2.3`, `v2.0.0-beta.1`

## Branch Cleanup

### After Merge:
```bash
# Delete local branch
git branch -d feature/completed-feature

# Delete remote branch (if not auto-deleted by GitHub)
git push origin --delete feature/completed-feature
```

### Prune Deleted Remote Branches:
```bash
git fetch --prune
```

## Emergency Procedures

### Reverting a Bad Merge:
```bash
# Find the merge commit
git log --oneline --graph

# Revert the merge
git revert -m 1 <merge-commit-hash>

# Push revert
git push origin master
```

### Fixing a Broken master:
```bash
# Create hotfix branch
git checkout -b hotfix/fix-master

# Fix the issue
# ... make changes ...

# Quick PR and merge
git push -u origin hotfix/fix-master
```

## Best Practices

1. **Keep branches short-lived** - Merge within days, not weeks
2. **Regularly sync with master** - Rebase or merge master into feature branches
3. **Write clear commit messages** - Use conventional commits
4. **One feature per branch** - Don't mix unrelated changes
5. **Test before pushing** - Run tests locally first
6. **Small, focused PRs** - Easier to review and merge
7. **Delete merged branches** - Keep repository clean
8. **Use draft PRs** - For work in progress